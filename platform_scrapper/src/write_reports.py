import os
import json
import pprint


def clean_data(list_of_circle_sections, store="aaa", address='bb', reporter=None):
    final_data = {}
    for item in list_of_circle_sections:
        if str(item)[0].isdigit():
            if type(list_of_circle_sections[item]) is list:
                final_data[item] = list_of_circle_sections[item]
        if type(item) is dict:
            for key, value in item.items():
                if key:
                    for k1, v1 in value.items():
                        max_distance = max(v1.keys())
                        if key not in final_data:
                            final_data[key] = {}
                        if k1 not in final_data[key]:
                            final_data[key][k1] = {}
                        final_data[key][k1][max_distance] = v1[max_distance]
    res = {}
    for price in final_data:
        if type(final_data[price]) is list:
            res = final_data
            break
        if price not in res:
            res[price] = []
            for degree in final_data[price]:
                for km in final_data[price][degree]:
                    res[price].append(final_data[price][degree][km])

    filename = str(store) + str(address)
    filename = str(store) + str(address)
    if not reporter:
        with open(f"tmp__{filename}.json", 'w') as file:
            json.dump(res, file, indent=2)
        pprint.pprint(res)
    return res


def write_report(global_data, store, address, status, url, ecom_provider, service_options, index):
    store_l = str(store).capitalize()
    address_l = str(address).capitalize()
    filename = store_l + address_l
    liner = f"\n{60 * '-'}\n"
    with open(f"{index}glob.txt", "w") as file:
        if not global_data:
            result = f"Delivery info for {store} at address {address} NOT Found from {ecom_provider} ecommerse provider's server"
            json.dump(result, file, indent=2)
        else:
            json.dump(global_data, file, indent=2)
    with open(f"{index}{filename}.txt", "a") as f:
        report = f"Store - {store}{liner}Address - {address}{liner}{status}{liner}URL {url}{liner}Platform - {ecom_provider}{liner}Service options\n{service_options}{liner}Delivery Zones according to the price\nfirst number is the price, and in brackets are the coordinates of area according to that price \n"
        f.write(report)
        with open(f'{index}glob.txt', 'r') as glob_file:
            for line in glob_file:
                f.write(line)
    os.remove(f'{index}glob.txt')


x = [
  {
    "0": {
      "0": {
        "0.5": [
          [
            43.17039491155972,
            -79.47621099999999
          ]
        ],
        "0.9": [
          [
            43.17849600341151,
            -79.47621099999999
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.1901975602024,
            -79.47621099999999
          ],
          "min order - 40.0"
        ],
        "1.7000000000000002": [
          [
            43.20549955975515,
            -79.47621099999999
          ],
          "min order - 40.0"
        ],
        "2.1": [
          [
            43.22440197306746,
            -79.47621099999999
          ],
          "min order - 40.0"
        ]
      },
      "15": {
        "0.5": [
          [
            43.170241545930665,
            -79.47461955011877
          ]
        ],
        "0.9": [
          [
            43.17806656430475,
            -79.47175457457183
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.18936932660463,
            -79.46761551305765
          ],
          "min order - 40.0"
        ],
        "1.7000000000000002": [
          [
            43.20414979791659,
            -79.46220158765176
          ],
          "min order - 40.0"
        ],
        "2.1": [
          [
            43.22240793691994,
            -79.45551180210097
          ],
          "min order - 40.0"
        ]
      },
      "30": {
        "0.5": [
          [
            43.16979190284559,
            -79.47313657746842
          ]
        ],
        "0.9": [
          [
            43.17680752174591,
            -79.46760198342908
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.186941092227606,
            -79.45960624753788
          ],
          "min order - 40.0"
        ]
      },
      "45": {
        "0.5": [
          [
            43.169076630714954,
            -79.47186316069148
          ]
        ],
        "0.9": [
          [
            43.17480470252607,
            -79.46403631851804
          ],
          "min order - 40.0"
        ]
      },
      "60": {
        "0.5": [
          [
            43.16814448231705,
            -79.470886087076
          ]
        ],
        "0.9": [
          [
            43.172194629775234,
            -79.46130061046685
          ],
          "min order - 40.0"
        ]
      }
    }
  },
  {
    "0": {
      "72": {
        "0.5": [
          [
            43.16728491640602,
            -79.47036333998447
          ]
        ],
        "0.9": [
          [
            43.16978780986649,
            -79.45983712216027
          ],
          "min order - 40.0"
        ]
      },
      "87": {
        "0.5": [
          [
            43.16612967914833,
            -79.4700709485331
          ]
        ],
        "0.9": [
          [
            43.16655312434497,
            -79.45901877953106
          ],
          "min order - 40.0"
        ]
      },
      "102": {
        "0.5": [
          [
            43.164958411738056,
            -79.47019699614849
          ]
        ],
        "0.9": [
          [
            43.16327358490312,
            -79.45937208667611
          ],
          "min order - 40.0"
        ]
      },
      "117": {
        "0.5": [
          [
            43.16385093279,
            -79.47073286984103
          ]
        ],
        "0.9": [
          [
            43.16017268116163,
            -79.46087282706944
          ],
          "min order - 40.0"
        ]
      },
      "132": {
        "0.5": [
          [
            43.162882709844965,
            -79.4716420325691
          ]
        ],
        "0.9": [
          [
            43.15746171223388,
            -79.46341861824041
          ],
          "min order - 40.0"
        ]
      }
    }
  },
  {
    "0": {
      "144": {
        "0.5": [
          [
            43.16225316909161,
            -79.47259724396417
          ]
        ],
        "0.9": [
          [
            43.15569904544829,
            -79.46609317831623
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.14623184608685,
            -79.45669986676224
          ],
          "min order - 40.0"
        ]
      },
      "159": {
        "0.5": [
          [
            43.161692592718595,
            -79.47400774210116
          ]
        ],
        "0.9": [
          [
            43.154129481273145,
            -79.47004236698083
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.14320492517849,
            -79.46431562290326
          ],
          "min order - 40.0"
        ]
      },
      "174": {
        "0.5": [
          [
            43.1614183379318,
            -79.47556835845666
          ]
        ],
        "0.9": [
          [
            43.15336159475379,
            -79.47441175564575
          ],
          "min order - 40.0"
        ]
      },
      "189": {
        "0.5": [
          [
            43.16144909090609,
            -79.47717276039832
          ]
        ],
        "0.9": [
          [
            43.153447699982785,
            -79.47890370324737
          ],
          "min order - 40.0"
        ]
      },
      "204": {
        "0.5": [
          [
            43.161782756319276,
            -79.47871163388925
          ]
        ],
        "0.9": [
          [
            43.15438193088758,
            -79.48321223168624
          ],
          "min order - 40.0"
        ]
      }
    },
    "5.0": {
      "174": {
        "1.3": [
          [
            43.14172405297606,
            -79.47274142404896
          ]
        ],
        "1.7000000000000002": [
          [
            43.12650568836568,
            -79.47055768582777
          ],
          "min order - 50.0"
        ],
        "2.1": [
          [
            43.10770646994935,
            -79.46786095252294
          ],
          "min order - 50.0"
        ],
        "2.5": [
          [
            43.08532636001604,
            -79.4646517246726
          ],
          "min order - 50.0"
        ]
      },
      "189": {
        "1.3": [
          [
            43.14189010708958,
            -79.48140348300898
          ]
        ],
        "1.7000000000000002": [
          [
            43.12677628544136,
            -79.48467162085022
          ],
          "min order - 50.0"
        ],
        "2.1": [
          [
            43.108106201612955,
            -79.48870750508681
          ],
          "min order - 50.0"
        ],
        "2.5": [
          [
            43.08587981554402,
            -79.49351039174677
          ],
          "min order - 50.0"
        ]
      },
      "204": {
        "1.3": [
          [
            43.143691775976016,
            -79.48971196233764
          ]
        ],
        "1.7000000000000002": [
          [
            43.129712238229345,
            -79.49820967411287
          ],
          "min order - 50.0"
        ],
        "2.1": [
          [
            43.11244325869035,
            -79.50870389558668
          ],
          "min order - 50.0"
        ],
        "2.5": [
          [
            43.091884772824365,
            -79.52119283688968
          ],
          "min order - 50.0"
        ],
        "2.9": [
          [
            43.068036710543986,
            -79.53567439122529
          ],
          "min order - 50.0"
        ]
      }
    }
  },
  {
    "0": {
      "216": {
        "0.5": [
          [
            43.16225316909161,
            -79.47982475603581
          ]
        ],
        "0.9": [
          [
            43.15569904544829,
            -79.48632882168376
          ],
          "min order - 40.0"
        ]
      },
      "231": {
        "0.5": [
          [
            43.16306187178345,
            -79.4809890255495
          ]
        ],
        "0.9": [
          [
            43.157963353829224,
            -79.48958875644527
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.15059861251173,
            -79.50200909841118
          ],
          "min order - 40.0"
        ]
      },
      "246": {
        "0.5": [
          [
            43.16406359748025,
            -79.48182772462185
          ]
        ],
        "0.9": [
          [
            43.16076813297985,
            -79.49193728557006
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.15600772763176,
            -79.50653885118521
          ],
          "min order - 40.0"
        ]
      },
      "261": {
        "0.5": [
          [
            43.16519008776105,
            -79.48228368670584
          ]
        ],
        "0.9": [
          [
            43.16392227346675,
            -79.49321429675808
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.162090650525215,
            -79.50900248410835
          ],
          "min order - 40.0"
        ]
      },
      "276": {
        "0.5": [
          [
            43.166364578778634,
            -79.48232581916731
          ]
        ],
        "0.9": [
          [
            43.16721084517645,
            -79.49333264563265
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.168432889833774,
            -79.50923171196509
          ],
          "min order - 40.0"
        ]
      }
    },
    "5.0": {
      "216": {
        "1.3": [
          [
            43.14623184608685,
            -79.49572213323775
          ]
        ],
        "1.7000000000000002": [
          [
            43.13385148368343,
            -79.50800321637675
          ],
          "min order - 50.0"
        ],
        "2.1": [
          [
            43.11855786661784,
            -79.5231701872704
          ],
          "min order - 50.0"
        ],
        "2.5": [
          [
            43.100350899018046,
            -79.54122075398881
          ],
          "min order - 50.0"
        ],
        "2.9": [
          [
            43.07923048080465,
            -79.56215221821496
          ],
          "min order - 50.0"
        ]
      },
      "231": {
        "1.7000000000000002": [
          [
            43.1409675116728,
            -79.51824853445852
          ]
        ],
        "2.1": [
          [
            43.12906991268193,
            -79.53830512575045
          ],
          "min order - 50.0"
        ]
      },
      "246": {
        "1.7000000000000002": [
          [
            43.149782201591734,
            -79.52563126824407
          ]
        ],
        "2.1": [
          [
            43.142091374091954,
            -79.54921306234856
          ],
          "min order - 50.0"
        ],
        "2.5": [
          [
            43.132935063494656,
            -79.57728243843529
          ],
          "min order - 50.0"
        ]
      },
      "261": {
        "1.7000000000000002": [
          [
            43.15969501224578,
            -79.52964776871396
          ]
        ],
        "2.1": [
          [
            43.1567351518631,
            -79.5551495365432
          ],
          "min order - 50.0"
        ],
        "2.5": [
          [
            43.15321086256143,
            -79.58550703960015
          ],
          "min order - 50.0"
        ]
      },
      "276": {
        "1.7000000000000002": [
          [
            43.170030503270205,
            -79.53002334067732
          ]
        ],
        "2.1": [
          [
            43.1720034758684,
            -79.55570794419043
          ],
          "min order - 50.0"
        ],
        "2.5": [
          [
            43.17435159785769,
            -79.5862860248073
          ],
          "min order - 50.0"
        ],
        "2.9": [
          [
            43.177074659297844,
            -79.62175817469449
          ],
          "min order - 50.0"
        ]
      }
    }
  },
  {
    "0": {
      "288": {
        "0.5": [
          [
            43.16728491640602,
            -79.48205866001551
          ]
        ],
        "0.9": [
          [
            43.16978780986649,
            -79.49258487783972
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.17340278752868,
            -79.50779031149884
          ],
          "min order - 40.0"
        ]
      },
      "303": {
        "0.5": [
          [
            43.168345392973976,
            -79.48136773369741
          ]
        ],
        "0.9": [
          [
            43.17275719028899,
            -79.49065052247096
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.179129538491665,
            -79.50406038945235
          ],
          "min order - 40.0"
        ],
        "2.9": [
          [
            43.22422129299468,
            -79.5990050037001
          ],
          "min order - 40.0"
        ]
      },
      "318": {
        "0.5": [
          [
            43.169238832559294,
            -79.48032534330453
          ]
        ],
        "0.9": [
          [
            43.17525887965843,
            -79.48773188867895
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.183954337996575,
            -79.49843175025896
          ],
          "min order - 40.0"
        ]
      },
      "333": {
        "0.5": [
          [
            43.1699043403829,
            -79.47900252236329
          ]
        ],
        "0.9": [
          [
            43.17712235690384,
            -79.48402785440702
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.18754829371132,
            -79.4912879026296
          ],
          "min order - 40.0"
        ],
        "1.7000000000000002": [
          [
            43.20118208945407,
            -79.50078392551643
          ],
          "min order - 40.0"
        ],
        "2.1": [
          [
            43.21802367725131,
            -79.51251753458843
          ],
          "min order - 40.0"
        ]
      },
      "348": {
        "0.5": [
          [
            43.17029655529507,
            -79.47748942729831
          ]
        ],
        "0.9": [
          [
            43.178220595967915,
            -79.4797908939738
          ],
          "min order - 40.0"
        ],
        "1.3": [
          [
            43.18966639817014,
            -79.48311585582398
          ],
          "min order - 40.0"
        ],
        "1.7000000000000002": [
          [
            43.20463393150511,
            -79.48746494568779
          ],
          "min order - 40.0"
        ],
        "2.1": [
          [
            43.2231231590206,
            -79.4928389740274
          ],
          "min order - 40.0"
        ]
      }
    },
    "5.0": {
      "288": {
        "1.7000000000000002": [
          [
            43.178129655763406,
            -79.52767587391298
          ]
        ],
        "2.1": [
          [
            43.1839682201208,
            -79.55224273310257
          ],
          "min order - 50.0"
        ],
        "2.5": [
          [
            43.19091828528599,
            -79.58149231246739
          ],
          "min order - 50.0"
        ],
        "2.9": [
          [
            43.198979655034684,
            -79.61542629113832
          ],
          "min order - 50.0"
        ],
        "3.3": [
          [
            43.208152132188786,
            -79.65404660440196
          ],
          "min order - 50.0"
        ]
      },
      "303": {
        "1.7000000000000002": [
          [
            43.187462281933286,
            -79.52159875451011
          ]
        ],
        "2.1": [
          [
            43.197755262708895,
            -79.5432674349363
          ],
          "min order - 50.0"
        ],
        "2.5": [
          [
            43.210008320596266,
            -79.56906864633308
          ],
          "min order - 50.0"
        ],
        "3.3": [
          [
            43.240394014863526,
            -79.63307952272334
          ],
          "min order - 50.0"
        ]
      },
      "318": {
        "1.7000000000000002": [
          [
            43.19532510035555,
            -79.512426474546
          ]
        ],
        "2.1": [
          [
            43.20937105554656,
            -79.52971804146762
          ],
          "min order - 50.0"
        ],
        "2.5": [
          [
            43.22609208835686,
            -79.55030886573587
          ],
          "min order - 50.0"
        ]
      },
      "333": {
        "2.5": [
          [
            43.23807298466272,
            -79.52649069574188
          ]
        ]
      }
    }
  }
]

# clean_data(x, reporter=False)
# clean_data(null, "null31 CELINA ST", "The Peace Pipe")

